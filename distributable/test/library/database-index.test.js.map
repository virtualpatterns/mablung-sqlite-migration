{"version":3,"sources":["../../../source/test/library/database-index.test.js"],"names":["FileSystem","Path","Test","Migration","test","databasePath","ensureDir","dirname","onInstall","database","onOpen","detail","isMigrationInstalled","title","log","is","uninstallMigration","installMigration"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,UAAvB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,IAAP,MAAiB,KAAjB;;AAEA,SAASC,SAAT,QAA0B,gBAA1B;;AAEAD,IAAI,CAAC,sBAAD,EAAyB,MAAOE,IAAP,IAAgB;;AAE3C,MAAIC,YAAY,GAAG,yCAAnB;AACA,QAAML,UAAU,CAACM,SAAX,CAAqBL,IAAI,CAACM,OAAL,CAAaF,YAAb,CAArB,CAAN;;AAEA,QAAMF,SAAS,CAACK,SAAV,CAAqBC,QAAD,IAAc;AACtC,WAAOA,QAAQ,CAACC,MAAT,CAAgB,YAAY;;AAEjC,UAAIC,MAAM,GAAG,IAAb;AACC,OAAE,EAAEA,MAAF,EAAF,IAAiB,MAAMF,QAAQ,CAACG,oBAAT,CAA8BR,IAAI,CAACS,KAAnC,EAA0C,IAA1C,CAAvB;;AAEDT,MAAAA,IAAI,CAACU,GAAL,CAASH,MAAT;AACAP,MAAAA,IAAI,CAACW,EAAL,CAAQJ,MAAR,EAAgB,2EAAhB;;AAEC,OAAE,EAAEA,MAAF,EAAF,IAAiB,MAAMF,QAAQ,CAACO,kBAAT,CAA4BZ,IAAI,CAACS,KAAjC,EAAwC,IAAxC,CAAvB;;AAEDT,MAAAA,IAAI,CAACU,GAAL,CAASH,MAAT;AACAP,MAAAA,IAAI,CAACW,EAAL,CAAQJ,MAAR,EAAgB,kEAAhB;;AAED,KAbM,CAAP;AAcD,GAfK,EAeHN,YAfG,CAAN;;AAiBA,QAAMF,SAAS,CAACc,gBAAV,CAA2BZ,YAA3B,CAAN;;AAED,CAxBG,CAAJ","sourcesContent":["import FileSystem from 'fs-extra'\nimport Path from 'path'\nimport Test from 'ava'\n\nimport { Migration } from './migration.js'\n\nTest('migrationByNameIndex', async (test) => {\n\n  let databasePath = 'process/data/migration-by-name-index.db'\n  await FileSystem.ensureDir(Path.dirname(databasePath))\n\n  await Migration.onInstall((database) => {\n    return database.onOpen(async () => {\n    \n      let detail = null\n      ;[ { detail } ] = await database.isMigrationInstalled(test.title, true)\n\n      test.log(detail)\n      test.is(detail, 'SEARCH TABLE migration USING COVERING INDEX migrationByNameIndex (name=?)')\n\n      ;[ { detail } ] = await database.uninstallMigration(test.title, true)\n\n      test.log(detail)\n      test.is(detail, 'SEARCH TABLE migration USING INDEX migrationByNameIndex (name=?)')\n\n    })\n  }, databasePath)\n\n  await Migration.installMigration(databasePath)\n\n})\n"],"file":"database-index.test.js"}