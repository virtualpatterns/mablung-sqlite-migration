{"version":3,"sources":["../../../source/library/migration/00000000000020-create-index-migration-by-name.js"],"names":["Migration","BaseMigration","constructor","path","database","isInstalled","_database","open","existsIndexMigrationByName","close","install","statement","run","uninstall"],"mappings":"AAAA,SAASA,SAAS,IAAIC,aAAtB,QAA2C,iBAA3C;;AAEA,MAAMD,SAAN,SAAwBC,aAAxB,CAAsC;;AAEpCC,EAAAA,WAAW,CAACC,IAAD,EAAOC,QAAP,EAAiB;AAC1B,UAAMD,IAAN,EAAYC,QAAZ;AACD;;AAED,QAAMC,WAAN,GAAoB;;AAElB,UAAM,KAAKC,SAAL,CAAeC,IAAf,EAAN;;AAEA,QAAI;AACF,aAAO,MAAM,KAAKD,SAAL,CAAeE,0BAAf,EAAb;AACD,KAFD,SAEU;AACR,YAAM,KAAKF,SAAL,CAAeG,KAAf,EAAN;AACD;;AAEF;;AAED,QAAMC,OAAN,GAAgB;;AAEd,QAAIC,SAAS,GAAG;;;sCAAhB;;AAKA,WAAO,KAAKL,SAAL,CAAeM,GAAf,CAAmBD,SAAnB,CAAP;;AAED;;AAED,QAAME,SAAN,GAAkB;AAChB,WAAO,KAAKP,SAAL,CAAeM,GAAf,CAAmB,iCAAnB,CAAP;AACD,GA/BmC;;;;AAmCtC,eAAeZ,SAAf","sourcesContent":["import { Migration as BaseMigration } from '../migration.js'\n\nclass Migration extends BaseMigration {\n\n  constructor(path, database) {\n    super(path, database)\n  }\n\n  async isInstalled() {\n\n    await this._database.open()\n\n    try {\n      return await this._database.existsIndexMigrationByName()\n    } finally {\n      await this._database.close()\n    }\n\n  }\n\n  async install() {\n\n    let statement = ' create index migrationByNameIndex on migration ( \\\n                        name, \\\n                        installed, \\\n                        uninstalled )'\n\n    return this._database.run(statement)\n\n  }\n\n  async uninstall() {\n    return this._database.run('drop index migrationByNameIndex')\n  }\n\n}\n\nexport default Migration\n"],"file":"00000000000020-create-index-migration-by-name.js"}